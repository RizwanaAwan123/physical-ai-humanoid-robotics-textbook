---
id: chapter3-sections-3-3-inverse-kinematics
title: "Inverse Kinematics: Solving for Joint Angles"
---

## 3.3 Inverse Kinematics: Solving for Joint Angles

Inverse Kinematics (IK) is the process of determining the joint angles (or other joint parameters) required to achieve a desired end-effector position and orientation in space. Unlike forward kinematics, which has a unique solution, inverse kinematics can often have multiple solutions, no solution, or a continuum of solutions. This makes IK a more challenging problem but a crucial one for tasks where a robot needs to reach a specific target.

### Analytical vs. Numerical Solutions

*   **Analytical Solutions:** Involve closed-form mathematical expressions that directly compute joint angles. These are typically fast and accurate but are only available for simpler robot geometries (e.g., 2R planar arms, 3R spherical wrists) and may not exist for complex humanoids.
*   **Numerical Solutions:** Involve iterative algorithms that search for joint angles satisfying the desired end-effector pose. These are more general and can handle complex robot kinematics but are slower and may get stuck in local minima or fail to converge.

### Common Numerical IK Methods

1.  **Jacobian Pseudo-Inverse Method:** Uses the Jacobian matrix (which relates joint velocities to end-effector velocities) to iteratively move the end-effector towards the target.

    ```latex
    \dot{\mathbf{q}} = J^+ \dot{\mathbf{x}}
    ```
    Where $\dot{\mathbf{q}}$ is the joint velocity vector, $\dot{\mathbf{x}}$ is the end-effector velocity vector, and $J^+$ is the pseudo-inverse of the Jacobian matrix $J$.

2.  **Optimization-Based Methods:** Formulate IK as an optimization problem, minimizing the error between the current and desired end-effector pose.

    ```latex
    \min_{\mathbf{q}} ||f(\mathbf{q}) - \mathbf{x}_{target}||^2
    ```
    Where $f(\mathbf{q})$ is the forward kinematics function and $\mathbf{x}_{target}$ is the desired end-effector pose.

### Example: 2R Planar Arm Inverse Kinematics (Analytical) in Python

For a 2R planar arm, analytical solutions are possible.

```python
import numpy as np

def inverse_kinematics_2r_planar(l1, l2, target_x, target_y):
    # Calculate D-squared, distance from base to target squared
    D_squared = target_x**2 + target_y**2

    # Calculate theta2 (Elbow angle)
    cos_theta2 = (D_squared - l1**2 - l2**2) / (2 * l1 * l2)

    if not (-1 <= cos_theta2 <= 1):
        print("Target out of reach.")
        return None, None

    # Two solutions for theta2 (elbow up/elbow down)
    theta2_1 = np.arctan2(np.sqrt(1 - cos_theta2**2), cos_theta2)
    theta2_2 = np.arctan2(-np.sqrt(1 - cos_theta2**2), cos_theta2)

    # Calculate theta1 (Shoulder angle) for theta2_1
    k1 = l1 + l2 * np.cos(theta2_1)
    k2 = l2 * np.sin(theta2_1)
    theta1_1 = np.arctan2(target_y, target_x) - np.arctan2(k2, k1)

    # Calculate theta1 (Shoulder angle) for theta2_2
    k1 = l1 + l2 * np.cos(theta2_2)
    k2 = l2 * np.sin(theta2_2)
    theta1_2 = np.arctan2(target_y, target_x) - np.arctan2(k2, k1)

    return np.degrees(theta1_1), np.degrees(theta2_1), np.degrees(theta1_2), np.degrees(theta2_2)

# Link lengths
l1 = 1.0 # meter
l2 = 0.8 # meter

# Target end-effector position
target_x = 1.0
target_y = 1.0

theta1_a, theta2_a, theta1_b, theta2_b = inverse_kinematics_2r_planar(l1, l2, target_x, target_y)

if theta1_a is not None:
    print(f"Solution 1: Theta1 = {theta1_a:.2f} deg, Theta2 = {theta2_a:.2f} deg")
    print(f"Solution 2: Theta1 = {theta1_b:.2f} deg, Theta2 = {theta2_b:.2f} deg")

# For ROS, libraries like MoveIt! are commonly used for IK. You'd define a target pose
# and let MoveIt! solve the IK problem for your robot's URDF model.
# Example command (conceptual):
# rosservice call /compute_ik "robot_state: {...}, pose_stamped: {...}"
```

### ASCII Diagram: Multiple IK Solutions for 2R Arm

```
  Y ^
    |
    O--------> Target (x,y)
   / \       /
  /   \     /
 O-----O   /
       (Elbow up)

  Y ^
    |
    O--------> Target (x,y)
   / \       \
  /   \     \
 O-----O   \ (Elbow down)
```

### Multiple Choice Question

Which of the following statements about Inverse Kinematics (IK) is generally TRUE?

a) IK always has a unique solution for any robot configuration.

b) Numerical IK solutions are always faster than analytical solutions.

c) IK aims to find joint parameters for a desired end-effector pose.

d) Analytical IK methods are suitable for highly complex robot geometries.

**Answer:** c)

### Short Question

When might an inverse kinematics problem have no solution? Provide an example related to a robot arm.

### Assignment

Research and briefly describe the concept of *redundancy* in robot manipulators in the context of inverse kinematics. Why can redundancy be advantageous, and what challenges does it introduce for IK solvers? Provide an example of a redundant robotic system.
