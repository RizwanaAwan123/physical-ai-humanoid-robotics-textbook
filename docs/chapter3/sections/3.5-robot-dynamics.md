---
id: 3.5-robot-dynamics
title: "Robot Dynamics: Lagrangian and Newton-Euler Formulations"
---

## 3.5 Robot Dynamics: Lagrangian and Newton-Euler Formulations

Robot dynamics is concerned with the relationship between the forces/torques applied to a robot and the resulting motion (accelerations). Understanding dynamics is essential for accurate control, especially for high-speed or high-force tasks, and for simulating robot behavior realistically. Two primary formulations are commonly used: Lagrangian dynamics and Newton-Euler dynamics.

### Lagrangian Dynamics

The Lagrangian formulation is an energy-based approach. It starts with defining the Lagrangian $L$ as the difference between the kinetic energy $K$ and potential energy $P$ of the system:

```latex
L = K - P
```

The equations of motion are then derived from the Euler-Lagrange equations:

```latex
\frac{d}{dt} \left( \frac{\partial L}{\partial \dot{q}_i} \right) - \frac{\partial L}{\partial q_i} = \tau_i
```
Where $q_i$ are the generalized coordinates (e.g., joint angles), $\dot{q}_i$ are generalized velocities, and $\tau_i$ are generalized forces (e.g., joint torques).

This typically results in the following form for a robot manipulator:

```latex
M(\mathbf{q})\ddot{\mathbf{q}} + C(\mathbf{q}, \dot{\mathbf{q}})\dot{\mathbf{q}} + G(\mathbf{q}) = \tau
```
Where:
*   $M(\mathbf{q})$ is the mass matrix (inertia matrix)
*   $C(\mathbf{q}, \dot{\mathbf{q}})$ represents Coriolis and centrifugal forces
*   $G(\mathbf{q})$ represents gravitational forces
*   $\tau$ is the vector of joint torques

### Newton-Euler Dynamics

The Newton-Euler formulation is a force-based approach that applies Newton's second law and Euler's equations for rigid bodies iteratively along the robot's links. It calculates the forces and moments acting on each link, typically in two passes: a forward pass from base to end-effector to compute velocities and accelerations, and a backward pass from end-effector to base to compute joint forces/torques.

This method is generally more computationally intensive for symbolic derivation but more efficient for numerical computation, especially for real-time control.

### Example: Simple Pendulum Dynamics in Python (Conceptual)

Let's consider a simple pendulum for illustration of dynamic equations. Its Lagrangian is $L = \frac{1}{2}ml^2\dot{\theta}^2 - mgl\cos\theta$. The equation of motion is:

```latex
ml^2\ddot{\theta} + mgl\sin\theta = \tau
```

```python
import numpy as np
from scipy.integrate import odeint
import matplotlib.pyplot as plt

# Parameters
m = 1.0 # mass (kg)
l = 1.0 # length (m)
g = 9.81 # gravity (m/s^2)

def pendulum_dynamics(y, t, m, l, g):
    theta, omega = y # y = [theta, omega]

    # No external torque for this example
    tau = 0.0

    # Equation of motion: ml^2 * ddot_theta + mgl*sin(theta) = tau
    # ddot_theta = (tau - mgl*sin(theta)) / (m*l^2)
    ddot_theta = (tau - m * g * l * np.sin(theta)) / (m * l**2)

    return [omega, ddot_theta]

# Initial conditions: [theta (rad), omega (rad/s)]
y0 = [np.pi / 4, 0.0] # Start at 45 degrees, zero velocity

# Time points
t = np.linspace(0, 10, 250) # Simulate for 10 seconds

# Solve ODE
sol = odeint(pendulum_dynamics, y0, t, args=(m, l, g))

theta_rad = sol[:, 0]
theta_deg = np.degrees(theta_rad)

plt.figure(figsize=(10, 4))
plt.plot(t, theta_deg)
plt.title("Simple Pendulum Angle over Time")
plt.xlabel("Time (s)")
plt.ylabel("Angle (degrees)")
plt.grid(True)
plt.show()

# In ROS, libraries like `ros_control` and `gazebo` handle dynamics simulation.
# You would typically define your robot's URDF with inertia parameters, and Gazebo
# (or other physics engine) would solve the dynamics.
```

### ASCII Diagram: Robot Dynamics Components

```
  Torques (tau)
       |
       V
   +----------+
   |  ROBOT   |
   | DYNAMICS |
   +----------+
       |
       V
Accelerations (ddot_q)
       |
       V
  Velocities (dot_q)
       |
       V
   Positions (q)
```

### Multiple Choice Question

Which term in the robot manipulator dynamics equation $M(\mathbf{q})\ddot{\mathbf{q}} + C(\mathbf{q}, \dot{\mathbf{q}})\dot{\mathbf{q}} + G(\mathbf{q}) = \tau$ accounts for the effects of gravity?

a) $M(\mathbf{q})\ddot{\mathbf{q}}$

b) $C(\mathbf{q}, \dot{\mathbf{q}})\dot{\mathbf{q}}$

c) $G(\mathbf{q})$

d) $\tau$

**Answer:** c)

### Short Question

Compare and contrast the Lagrangian and Newton-Euler formulations for robot dynamics, highlighting their respective strengths and weaknesses.

### Assignment

Research the concept of *inverse dynamics* in robotics. Explain its purpose and how it differs from forward dynamics. Provide an example of a robotics application where inverse dynamics is essential for control.
