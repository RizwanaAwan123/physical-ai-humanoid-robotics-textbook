---
id: chapter3-sections-3-6-balance-stability
title: "Balance and Stability: Zero Moment Point (ZMP) and Centroidal Dynamics"
---

## 3.6 Balance and Stability: Zero Moment Point (ZMP) and Centroidal Dynamics

Maintaining balance is perhaps the most critical challenge for bipedal and humanoid robots. Unlike wheeled robots, humanoids operate in a highly dynamic environment where gravity constantly threatens stability. Concepts like the Zero Moment Point (ZMP) and Centroidal Dynamics are fundamental to understanding and controlling the balance of these complex systems.

### Zero Moment Point (ZMP)

The ZMP is a key concept for stable bipedal locomotion. It is defined as the point on the ground where the net moment of all forces (gravitational, inertial, and contact forces) acting on the robot is zero. For a robot to be statically stable (not fall over), its ZMP must lie within its **Support Polygon** (the convex hull of its ground contact points, e.g., the area defined by its feet on the ground).

When walking, the ZMP trajectory is often planned to always remain within the support polygon, ensuring dynamic stability. The ZMP is calculated from the robot's dynamics and external forces.

```latex
ZMP_x = \frac{\sum_{i} m_i (\ddot{x}_i z_i - (g + \ddot{z}_i) x_i) + \sum_{j} (y_j F_{jx} - x_j F_{jy} - M_{jz})}{\sum_{i} m_i (g + \ddot{z}_i) - \sum_{j} F_{jz}}
```
(Similar for $ZMP_y$, simplified form shown)

### Centroidal Dynamics

Centroidal dynamics provides a simplified yet powerful model for controlling the whole-body motion of a robot by focusing on the dynamics of its Center of Mass (CoM). It decouples the full robot dynamics into motions of the CoM and angular momentum around the CoM. This allows for high-level planning of CoM trajectories to achieve desired locomotion patterns, while lower-level controllers handle joint movements to realize that CoM motion and maintain ZMP within bounds.

Key equations relate the CoM acceleration to the total external forces and moments.

```latex
m \ddot{\mathbf{c}} = \mathbf{F}_{ext}
\dot{\mathbf{L}}_{CoM} = \mathbf{M}_{ext, CoM}
```
Where $m$ is total mass, $\mathbf{\ddot{c}}$ is CoM acceleration, $\mathbf{F}_{ext}$ is total external force, $\mathbf{L}_{CoM}$ is angular momentum about CoM, and $\mathbf{M}_{ext, CoM}$ is total external moment about CoM.

### ASCII Diagram: ZMP and Support Polygon

```
               ^ Robot
               |
               |
          +----+----+
          |          |
          |          |
          +----+----+
         /            \
        /              \
   Foot 1-----------Foot 2
   (Contact points)

       [Support Polygon]
       * ZMP (must be inside)
```

### Example: Simple ZMP Calculation (Conceptual)

Calculating ZMP for a full humanoid is complex. Here, a conceptual Python snippet to illustrate the idea of checking ZMP within a simplified support base.

```python
import numpy as np

def check_zmp_in_support_polygon(zmp_x, zmp_y, support_polygon_vertices):
    # A simplified check for a rectangular support polygon for example
    # In reality, you'd use a robust point-in-polygon algorithm

    # Example: Check if ZMP is within a bounding box defined by min/max vertices
    min_x = min(v[0] for v in support_polygon_vertices)
    max_x = max(v[0] for v in support_polygon_vertices)
    min_y = min(v[1] for v in support_polygon_vertices)
    max_y = max(v[1] for v in support_polygon_vertices)

    if min_x <= zmp_x <= max_x and min_y <= zmp_y <= max_y:
        return True
    else:
        return False

# Example usage
zmp_current = (0.05, 0.02)
support_polygon = [
    (-0.1, -0.05), # Back-left
    (0.1, -0.05),  # Back-right
    (0.1, 0.05),   # Front-right
    (-0.1, 0.05)   # Front-left
] # Example vertices for a rectangular base

is_stable = check_zmp_in_support_polygon(zmp_current[0], zmp_current[1], support_polygon)
print(f"Current ZMP: {zmp_current}")
print(f"Is robot stable? {is_stable}")

# In ROS, ZMP and CoM calculations are often handled by whole-body controllers
# (e.g., using libraries like OpenHRP, or custom controllers in `ros_control`).
# You might subscribe to force/torque sensor data and robot state to estimate these.
```

### Multiple Choice Question

For a bipedal robot to maintain static stability, its Zero Moment Point (ZMP) must lie:

a) Exactly at the center of mass.

b) Outside its support polygon.

c) Within its support polygon.

d) On the trajectory of its feet.

**Answer:** c)

### Short Question

Explain how Centroidal Dynamics simplifies the control problem for humanoid locomotion compared to full body dynamics.

### Assignment

Research the concept of the *Linear Inverted Pendulum Model (LIPM)*. Explain how it is used in conjunction with ZMP control for generating stable walking gaits in humanoid robots. Discuss its advantages and limitations.
